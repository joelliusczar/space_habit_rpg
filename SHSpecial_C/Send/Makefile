SHDATETIME_PATH = ../SHDatetime/
SHUTILS_C_PATH = ../SHUtils_C/
include ../SHBase.mk
include $(SHDATETIME_PATH)vars.mk
include $(SHUTILS_C_PATH)vars.mk
include vars.mk
SH_LIB_SUFFIX?=_DueDates
SH_COLLECTION_FULL=$(call libfy,$(SH_COLLECTION))
DT_SHARED_S=$(DT_SHARED)$(SH_LIB_SUFFIX)
SHUTILS_C_S=$(SHUTILS_C)$(SH_LIB_SUFFIX)
DT_SHARED_FULL := $(SHDATETIME_PATH)$(call libfy,$(DT_SHARED_S))
SHUTILS_C_FULL := $(SHUTILS_C_PATH)$(call libfy,$(SHUTILS_C_S))
INC+=-I$(SHDATETIME_PATH) -I$(SHUTILS_C_PATH)
SHUTILS_C_HEADERS = $(call rwildcard,$(SHUTILS_C_PATH),*.h)
SHUTILS_C_SOURCES = $(call rwildcard,$(SHUTILS_C_PATH),*.c)
SHUTILS_C_OBJECTS=$(SHUTILS_C_SOURCES:.c=.o)
SHDATETIME_HEADERS:= $(call rwildcard,$(SHDATETIME_PATH),*.h)
SHDATETIME_SOURCES:= $(call rwildcard,$(SHDATETIME_PATH),*.c)
SHDATETIME_OBJECTS=$(SHDATETIME_SOURCES:.c=.o)
PARENT_PATH ?= .

.DEFAULT_GOAL:=$(SH_COLLECTION_FULL)


$(SH_COLLECTION_FULL): $(OBJECTS) $(DT_SHARED_FULL) $(SHUTILS_C_FULL)
	$(CC) $(INC) $(CFLAGS) $(OBJECTS) -Wl,-rpath,$(SHDATETIME_PATH),-rpath,$(SHUTILS_C_PATH) \
	-L$(SHDATETIME_PATH) -L$(SHUTILS_C_PATH) -l$(DT_SHARED_S) -l$(SHUTILS_C_S) \
	-shared -o $(SH_COLLECTION_FULL)

$(DT_SHARED_FULL): $(SHDATETIME_OBJECTS) $(SHUTILS_C_OBJECTS)
	cd $(SHDATETIME_PATH) && $(MAKE) PARENT_PATH=$(SHDATETIME_PATH) SH_LIB_SUFFIX=$(SH_LIB_SUFFIX)

COPY_CODE:
	

clean:
	cd .. && $(MAKE) clean
